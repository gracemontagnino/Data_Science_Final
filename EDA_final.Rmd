---
title: "Final Project EDA Notebook"
output: html_notebook
---

```{r}
library(dplyr)
library(tidyverse)
library(broom)
library(readxl)
library(modelr)
library(rsample)
```


```{r}
kids <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-09-15/kids.csv')
kids
```
list of vars: 
addCC
CTC -- Child Tax Credit
edservs -- Public spending on education special services by state and year, in $1,000s.
edsubs -- Public spending on education subsidies, including tuition and scholarships, by state and year, in $1,000s.
fedEITC
fedSSI
HCD -- housing and community developments
HeadStartPriv
highered -- higher education expenditures
lib -- libraries
Medicaid_CHIP
other_health
othercashserv
parkrec -- parks and rec
pell -- pell grant
PK12ed -- K12 expenditures
pubhealth
SNAP
socsec -- Public spending on Social Security payments that go to children by state and year, in $1,000s
stateEITC
TANFbasic
unemp -- unemployment
wcomp -- workers comp
```{r}
kids %>%
  group_by(state, variable) %>%
  filter(variable == c("highered","HeadStartPriv", "PK12ed", "SNAP", "HCD", "socsec")) %>%
  summarize(spent_pc = sum(inf_adj_perchild)) %>%
  ggplot() +
  geom_col(aes(state, spent_pc, fill = variable), position = "stack") +
  theme(axis.text.x = element_text(angle = 90)) +
  ggtitle("Money spent by each state per category")
 

```
```{r}
kids %>%
filter(state == "Texas" | state == "Delaware" | state == "Hawaii" | state == "Alaska") %>%
ggplot(aes(year, inf_adj_perchild, color = variable)) +
geom_line() +
facet_grid(cols = vars(state)) +
ggtitle("Money spent over time in each category") +
theme(axis.text.x = element_text(angle = 90)) 
  
```
```{r}
kids %>%
  group_by(variable) %>%
  summarize(sum = sum(inf_adj_perchild)) %>%
  ggplot(aes(variable, sum)) +
  geom_col() +
  theme(axis.text.x = element_text(angle = 90)) + 
  ggtitle("Total spent in US on kids in each category")
```
```{r}
df_income <- read_csv('https://raw.githubusercontent.com/rbyirdaw/US-median-household-income/master/median-household-income-by-state-master.csv')
df_income <-
  df_income %>%
  select("year", "state", "median income")

df_combo <- 
  df_income %>%
  left_join(kids, by = c("year","state")) %>%
  select("year", "state", "median income", "inf_adj_perchild", "variable") %>%
  filter (state!= "United States")

df_combo
names(df_combo)[names(df_combo) == "median income"] <- "median_income"
```
```{r}
df_combo %>%
  group_by(state) %>%
  filter(variable == "PK12ed") %>%
  ggplot(aes(x = median_income, y = inf_adj_perchild, color = state)) +
  geom_point()
```
```{r}
df_combo %>%
  filter(year == "2014") %>%
  select("state", "median_income", "inf_adj_perchild", "variable") %>%
  group_by(state) %>%
  summarize(sum = sum(inf_adj_perchild), income = mean(median_income)) %>%
  ggplot(aes(sum, income, color = state)) +
  geom_point() +
  ggtitle("Total money spent in 2014 on children in comparison to income median that year")
```

```{r}
combined_money <-
  df_combo %>%
  pivot_longer(names_to = "money_type",
               values_to = "amount",
               cols = c(median_income, inf_adj_perchild)) 
```
```{r}
df_combo %>%
  ggplot(aes(state, median_income)) +
  geom_col() +
  theme(axis.text.x = element_text(angle = 90)) 
```
```{r}

```

